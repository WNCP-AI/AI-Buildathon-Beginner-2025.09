# 4.2 Service Management: Managing Your Drone Service Listings

**‚è±Ô∏è Time to Complete:** 25-35 minutes
**üí∞ Estimated Cost:** Free (using existing Lovable project)
**üéØ Difficulty:** Beginner (Copy-paste prompts)
**üìã What You'll Learn:** CRUD operations, form handling, data validation, business logic

---

## Overview: Your Service Management System

### What You're Building
You're creating a complete service listing management system where drone operators can create, view, edit, and delete their service offerings. Think of it like creating your own "product catalog" where you list all the drone services you provide - from aerial photography to delivery services.

Your system will include:
- **Create New Services**: Easy-to-use forms for adding new service listings
- **View All Services**: Professional table showing all your active and inactive listings
- **Edit Services**: Quick editing capabilities to update prices, descriptions, or availability
- **Delete Services**: Safe removal with confirmation dialogs

### Why This Step Matters
This is the core of your operator business! Without service management, operators can't offer their services to customers. Every successful marketplace needs robust tools for sellers to manage their offerings.

In the real world, platforms like Airbnb, Uber, and TaskRabbit all have sophisticated service management systems. You're building the same type of functionality.

### What Makes This Special
- **Component Reusability**: We'll create reusable form and card components you can use throughout your app
- **Database Integration**: Everything saves automatically to Supabase with proper user authentication
- **Professional UX**: Loading states, error handling, and confirmation dialogs like real apps
- **Business Logic**: Pricing options, availability settings, and service categories

### üìù Ask Yourself Before Starting:
- Do you have your operator dashboard from Step 4.1 working?
- Can you see the "Create New Listing" button on your dashboard?
- Is your Lovable project still open and connected to Supabase?

**‚úÖ Pre-Check Complete:** I'm ready to build service management

---

## Part 1: Understanding Service Management

### Service Listing Components We'll Build

Based on marketplace best practices and professional platforms, your service management needs:

1. **Service Creation Form**
   - Service title and detailed description
   - Category selection (Photography, Delivery, Inspection, etc.)
   - Pricing options (hourly rate, fixed price, or custom quote)
   - Availability settings (days of week, hours of operation)
   - Service area coverage (distance radius from your base)
   - Equipment requirements and experience level needed

2. **Service List Display**
   - Clean table or card layout showing all your services
   - Status indicators (Active, Paused, Draft)
   - Quick action buttons (Edit, Delete, Toggle Active)
   - Performance metrics (views, inquiries, bookings)

3. **Edit Functionality**
   - Inline editing or popup forms
   - Real-time validation and saving
   - Cancel/save options with unsaved changes warnings

4. **Delete System**
   - Confirmation dialogs to prevent accidents
   - Smart handling (what happens if someone has booked this service?)
   - Option to deactivate instead of permanently delete

### Database Structure We're Using
Your services will be stored in the `listings` table with these key fields:
- `id`, `title`, `description`, `category`, `price_type`, `hourly_rate`, `fixed_price`
- `availability_days`, `availability_hours`, `service_radius`, `is_active`
- `operator_id` (connects to your user account)
- `created_at`, `updated_at`

### üìù Ask Yourself:
- Do I understand what CRUD means? (Create, Read, Update, Delete)
- Can I visualize how this connects to my dashboard?
- Am I ready to create professional business tools?

**‚úÖ Understanding Complete:** I know what we're building

---

## Part 2: Creating New Service Listings

Let's start by building the service creation form. This form will be comprehensive but beginner-friendly.

### Copy This Entire Prompt Into Lovable:

```
Create a comprehensive service creation page for drone operators with these specifications:

## Design Requirements (from Style Guide):
- Use SharedHeader component from previous steps
- Primary accent color: #BD1B04 for CTAs and important elements
- Hover state: #9D1503
- Background: #FFFFFF (white)
- Typography: Inter font family (Bold 28pt H1, SemiBold 22pt H2, Regular 16pt body)
- Component shadows: 0_2px_8px_rgba(0,0,0,0.04)
- Hover shadows: 0_4px_12px_rgba(0,0,0,0.08)
- Mobile padding: 20px, desktop padding: 24px
- 8pt grid system for consistent spacing

## Page Structure:
Create a new page called CreateService with:

### 1. Navigation
- SharedHeader at top
- "Back to Dashboard" link with arrow icon (Inter Regular 14pt, #6B6B6B)
- Page title: "Create New Service Listing" (Inter Bold 28pt, #1A1A1A)
- Subtitle: "Add a new drone service to your marketplace profile" (Inter Regular 16pt, #6B6B6B)

### 2. Form Container
- White background card with rounded-xl corners
- Shadow: 0_2px_8px_rgba(0,0,0,0.04)
- Padding: 24px on desktop, 20px on mobile
- Max width: 768px, centered

### 3. Form Fields:

**Service Information Section:**
- Section title: "Service Details" (Inter SemiBold 18pt)

**Title Field (required):**
- Label: "Service Title" with red asterisk
- Placeholder: "e.g., Professional Aerial Photography"
- Max 80 characters with live counter
- Text input with Inter Regular 16pt

**Category Dropdown (required):**
- Label: "Service Category" with red asterisk
- Options: Photography, Videography, Delivery, Inspection, Mapping, Real Estate, Events, Custom
- Styled select with chevron icon
- Default option: "Select a category"

**Description Textarea (required):**
- Label: "Service Description" with red asterisk
- Placeholder: "Describe your service, equipment used, and what makes you special..."
- Min 50, max 500 characters with live counter
- 4 rows minimum height
- Auto-expand as user types

**Pricing Section:**
- Section title: "Pricing Structure" (Inter SemiBold 18pt)
- Radio button group with three options:
  * "Hourly Rate" - shows number input for $/hour
  * "Fixed Price" - shows number input for total $
  * "Custom Quote" - shows info text "Customers will request quotes"
- Currency inputs with $ prefix
- Number validation (positive numbers only)

**Availability Section:**
- Section title: "When You're Available" (Inter SemiBold 18pt)
- Day checkboxes in horizontal row: Mon, Tue, Wed, Thu, Fri, Sat, Sun
- Time range selectors: "From" and "To" dropdowns
- Default: 9:00 AM to 6:00 PM
- Checkbox for "Available 24/7"

**Service Area Section:**
- Section title: "Service Coverage" (Inter SemiBold 18pt)
- Number input: "Service radius (miles)"
- Default value: 25
- Help text: "How far will you travel from your base location?"
- Range: 1-100 miles

**Equipment & Certifications (optional):**
- Section title: "Equipment & Qualifications" (Inter SemiBold 18pt)
- Checkbox list:
  * "4K Camera Equipment"
  * "Thermal Imaging Capability"
  * "Night Vision Equipment"
  * "Heavy Lift Capacity (>10 lbs)"
  * "FAA Part 107 Licensed"
  * "Fully Insured"
- Additional details textarea (optional, 200 chars)

### 4. Form Actions
- Two buttons at bottom:
  * "Cancel" - gray outline button, returns to dashboard
  * "Create Service Listing" - #BD1B04 background, white text
- Buttons: min-height 44px, rounded-lg, font-semibold
- Gap between buttons: 16px
- Full width on mobile, inline on desktop

## Functionality Requirements:
- All required fields must validate before submission
- Show inline error messages in red (#DC2626) below fields
- Disable submit button until form is valid
- Loading state on submit button when saving
- Connect to Supabase 'listings' table
- Include operator_id from authenticated user
- Set is_active to true by default
- After save, redirect to dashboard with success toast

## Mobile Responsiveness:
- Single column layout on mobile
- Full width form fields
- Stack buttons vertically on mobile
- Maintain 44px touch targets
- Proper keyboard handling for mobile inputs

Make this feel professional and trustworthy for business operators.
```

### After Pasting the Prompt:
1. Press Enter and wait for Lovable to generate
2. Watch the preview panel update
3. Look for the form appearing with all fields

### What You Should See:
- Professional form with clear sections
- All specified fields with proper styling
- Validation indicators (red asterisks)
- Mobile-responsive layout
- Submit and cancel buttons

### üìù Ask Yourself:
- Are all form fields displaying correctly?
- Does the validation show required fields?
- Is the form mobile-friendly?

**‚úÖ Creation Form Complete:** I can create new service listings

---

## Part 3: Displaying Service Lists

Now let's create a page that shows all the operator's service listings in a professional table format.

### Copy This Prompt Into Lovable:

```
Create a service management page that displays all service listings for the current operator:

## Design Requirements:
- Use SharedHeader component from previous steps
- Primary accent: #BD1B04, hover: #9D1503
- White backgrounds with shadows: 0_2px_8px_rgba(0,0,0,0.04)
- Inter font family throughout
- 8pt grid spacing system

## Page Layout:
Create ManageServices page with:

### 1. Header Section
- SharedHeader component at top
- Page title: "Manage Your Services" (Inter Bold 28pt)
- Action bar with:
  * "Create New Service" button (#BD1B04 bg, white text, links to /create-service)
  * "Back to Dashboard" link (gray text)
- Horizontal divider below

### 2. Service Count & Filters
- Text: "Showing X services" (Inter Regular 14pt, #6B6B6B)
- Search input: "Search services..." placeholder
- Category filter dropdown (All, Photography, Delivery, etc.)
- Layout: flex row on desktop, stack on mobile

### 3. Services Table (Desktop View)
Create responsive table with:

**Table Headers (Inter SemiBold 14pt, #4A4A4A):**
- Service Title (30% width)
- Category (15% width)
- Price (15% width)
- Status (15% width)
- Created (15% width)
- Actions (10% width)

**Table Rows:**
- White background, hover: gray-50
- Border between rows: 1px solid #E5E5E5
- Padding: 12px vertical, 16px horizontal

**Column Content:**
1. Title: Bold text, truncate if too long
2. Category: Colored badge (bg-blue-100, text-blue-800)
3. Price: Format based on type ($X/hr, $X fixed, "Quote")
4. Status: Toggle switch (green=active, gray=inactive)
5. Created: Formatted date (Jan 15, 2025)
6. Actions: Edit and Delete icon buttons

### 4. Mobile Card View
On screens < 768px, convert to cards:
- White cards with shadow
- Stack all information vertically
- Title at top (bold)
- Category badge below
- Price and status on same row
- Action buttons at bottom
- 16px gap between cards

### 5. Empty State
When no services exist:
- Center aligned content
- Icon or illustration (drone icon)
- Heading: "No services yet" (Inter SemiBold 22pt)
- Text: "Create your first service to start receiving bookings"
- "Create Service" button (#BD1B04)

### 6. Status Toggle Functionality
- Clicking toggle updates is_active in database
- Show loading spinner during update
- Success toast: "Service status updated"
- Optimistic UI update (change immediately)

### 7. Action Buttons
**Edit Button:**
- Pencil icon, #BD1B04 color
- Tooltip: "Edit service"
- Navigate to edit form

**Delete Button:**
- Trash icon, #DC2626 color
- Tooltip: "Delete service"
- Opens confirmation dialog

## Database Integration:
- Fetch from 'listings' table
- Filter by operator_id = current user
- Order by created_at DESC
- Real-time subscriptions for updates
- Handle loading and error states

## Search & Filter Logic:
- Search in title and description fields
- Category filter exact match
- Combine search and filter
- Update results as user types (debounced)
- Show "No results" when filters return empty

Make this feel like professional business software that operators would trust with their livelihood.
```

### What You Should See:
- Professional table layout on desktop
- Responsive cards on mobile
- Working search and filters
- Status toggles that save to database
- Empty state for new operators

### üìù Ask Yourself:
- Can I see all my test services in the table?
- Do the status toggles work properly?
- Does the mobile view display cards correctly?

**‚úÖ Service List Complete:** I can view and manage all services

---

## Part 4: Edit and Delete Functionality

Let's add the ability to edit existing services and safely delete them.

### Copy This Prompt Into Lovable:

```
Add complete edit and delete functionality to the service management system:

## EDIT FUNCTIONALITY:

### Edit Modal Design:
- Centered modal with backdrop (black 50% opacity)
- White modal content, rounded-xl corners
- Max width: 600px, margin: 20px
- Shadow: 0_20px_25px_-5px_rgba(0,0,0,0.1)
- Smooth fade-in animation (200ms)

### Modal Header:
- Title: "Edit Service" (Inter Bold 22pt)
- Close X button (top right, 32x32px clickable area)
- Divider line below header

### Modal Body:
- Exact same form as CreateService
- Pre-populate all fields with existing data
- Maintain all validation rules
- Show which fields have been modified

### Modal Footer:
- Two buttons, right-aligned:
  * "Cancel" - gray outline, closes modal
  * "Save Changes" - #BD1B04 bg, white text
- Buttons disabled during save operation
- Gap between buttons: 12px

### Unsaved Changes Warning:
- If user tries to close with changes:
- Show dialog: "You have unsaved changes. Are you sure you want to close?"
- Options: "Discard Changes" (red) and "Keep Editing" (gray)

## DELETE FUNCTIONALITY:

### Delete Confirmation Dialog:
- Smaller modal (max-width: 400px)
- Centered with backdrop
- White background, rounded corners

### Dialog Content:
- Warning icon (red, 48px)
- Title: "Delete Service?" (Inter Bold 18pt)
- Message: "Are you sure you want to delete '[Service Name]'? This action cannot be undone."
- Service details box showing:
  * Title, Category, Price
  * Gray background for context

### Dialog Actions:
- Two buttons:
  * "Cancel" - gray outline
  * "Delete Service" - red bg (#DC2626), white text
- Full width buttons on mobile

### Delete Process:
1. Show confirmation dialog
2. On confirm, show loading state
3. Delete from database
4. Remove from table with fade-out
5. Show success toast: "Service deleted successfully"
6. Update service count

## ADVANCED FEATURES:

### Keyboard Shortcuts:
- ESC key closes modals (with unsaved check)
- CMD/CTRL + S saves changes in edit mode
- Tab navigation through form fields

### Error Handling:
- Network errors: "Unable to save. Please try again."
- Validation errors: Inline under each field
- Delete errors: "Cannot delete service with active bookings"
- Always allow retry on failure

### Loading States:
- Disable form during save
- Show spinner on save button
- Prevent multiple submissions
- Gray out delete button during deletion

### Success Feedback:
- Green toast notifications for success
- Update table immediately (optimistic)
- Smooth transitions for all changes
- Clear success indicators

## Mobile Optimizations:
- Full screen modals on mobile
- Larger touch targets (44px minimum)
- Bottom sheet style for better reach
- Swipe down to close (with unsaved check)
- Native-feeling interactions

Make these interactions feel polished and bulletproof. Users should never lose data accidentally.
```

### What You Should See:
- Edit button opens modal with current data
- All form fields editable with validation
- Delete button shows confirmation dialog
- Successful saves update the table
- Unsaved changes protection works

### üìù Ask Yourself:
- Does edit modal show the current service data?
- Can I save changes successfully?
- Does delete confirmation prevent accidents?

**‚úÖ Edit/Delete Complete:** Full CRUD functionality working

---

## Part 5: Making It Professional

Let's add the finishing touches that make your service management feel like a real business application.

### Copy This Prompt Into Lovable:

```
Polish the service management system with professional features:

## ENHANCED TABLE FEATURES:

### Sorting Capabilities:
- Clickable column headers with sort indicators (‚Üë‚Üì)
- Sort by: Title (A-Z), Created (newest first), Price (high to low)
- Remember last sort preference
- Visual feedback on sorted column

### Bulk Operations:
- Checkbox column (first column)
- "Select All" checkbox in header
- Bulk actions bar appears when items selected
- Shows: "3 items selected"
- Actions: "Activate", "Deactivate", "Delete"
- Requires confirmation for bulk delete

### Pagination:
- Show 10 items per page
- Page controls: Previous, 1, 2, 3..., Next
- "Showing 1-10 of 23 services" text
- Smooth transitions between pages
- Maintain filters across pages

## BUSINESS METRICS SECTION:

### Summary Cards (above table):
Create 4 metric cards in a grid:

1. **Total Services**
   - Number with icon
   - Subtitle: "Active services"
   - Green if >5, gray otherwise

2. **Average Price**
   - Calculate from all services
   - Format: $XX.XX
   - Compare to market average

3. **Service Coverage**
   - Average radius in miles
   - Map pin icon
   - Help text on hover

4. **Completion Rate**
   - Mock: 94% for now
   - Progress bar visualization
   - Green/yellow/red based on percentage

### Performance Indicators:
- Add "Views" column (mock data: 0-500)
- Add "Bookings" column (mock data: 0-50)
- Color code: Green (high), Yellow (medium), Gray (low)
- Tooltips explaining metrics

## IMPROVED SEARCH & FILTERS:

### Advanced Search:
- Real-time search as you type
- Search highlights matching text
- Search in: title, description, category
- Clear search button (X)
- Search suggestions dropdown

### Filter Pills:
- Active filters show as removable pills
- "Photography √ó" style
- Clear all filters button
- Filter count badge

### Quick Filters:
- Preset buttons: "Active Only", "Needs Images", "Popular"
- Toggle style buttons
- Combine with other filters

## EXPORT & IMPORT:

### Export Services:
- "Export" button with download icon
- Formats: CSV, JSON
- Include all service data
- Filename: "services_YYYY-MM-DD.csv"

### Batch Import:
- "Import" button (advanced feature)
- Accept CSV upload
- Preview before importing
- Validation and error reporting

## MOBILE ENHANCEMENTS:

### Swipe Actions:
- Swipe right: Edit (blue background)
- Swipe left: Delete (red background)
- Smooth animations
- Haptic feedback if available

### Floating Action Button:
- "+" FAB in bottom right
- #BD1B04 background
- Links to create service
- Hides when scrolling down

### Pull to Refresh:
- Standard mobile pattern
- Refresh services from database
- Loading spinner during refresh

## PROFESSIONAL POLISH:

### Animations:
- Subtle hover effects on all interactive elements
- Smooth transitions (200ms ease)
- Fade in/out for appearing elements
- No jarring movements

### Loading Skeletons:
- Show skeleton rows while loading
- Shimmer effect animation
- Maintains layout (no jumps)
- Progressive content reveal

### Empty States:
- Different messages based on filters
- "No services match your search"
- "No services in Photography category"
- Always show path forward (create or clear filters)

### Tooltips & Help:
- Hover tooltips for all icons
- Help text for complex features
- Inline explanations where needed
- Link to help documentation

Make this feel like software that serious businesses would pay for. Every detail should inspire confidence.
```

### What You Should See:
- Sortable table columns with indicators
- Business metrics cards at top
- Advanced search with highlighting
- Professional animations and transitions
- Mobile-optimized with swipe actions

### üìù Ask Yourself:
- Do all the professional features work smoothly?
- Does it feel like real business software?
- Would I trust this to manage my business?

**‚úÖ Professional Polish Complete:** Service management is production-ready!

---

## Common Problems & Solutions

### Problem: "Services aren't saving to database"
**Solution:**
```
Debug service creation by checking:
1. Ensure you're authenticated as an operator
2. Verify the listings table exists in Supabase
3. Check that operator_id is being set from the current user
4. Add console.log to see exactly what data is being sent
Show any errors clearly in the UI.
```

### Problem: "Edit modal doesn't show current data"
**Solution:**
```
Fix the edit modal data population. Make sure you're passing the selected service object to the modal component. Pre-fill all form fields with the existing values. Check that field types (text, number, select, checkbox) all populate correctly.
```

### Problem: "Delete doesn't work or shows errors"
**Solution:**
```
Fix delete functionality by:
1. Ensuring the confirmation dialog appears
2. Checking you have permission to delete (operator owns the service)
3. Handling the case where services have existing bookings
4. Showing clear error messages if deletion fails
```

### Problem: "Table doesn't look good on mobile"
**Solution:**
```
Improve mobile responsiveness by converting the table to cards on screens smaller than 768px. Each card should clearly show all service information with large, touch-friendly buttons. Ensure text remains readable and actions are easy to tap.
```

### Problem: "Search and filters don't work"
**Solution:**
```
Fix search and filtering by:
1. Making search look in both title and description fields
2. Ensuring category filter shows exact matches
3. Making search and filter work together
4. Adding debouncing to prevent too many database queries
```

### üìù Ask Yourself:
- Have I encountered any of these issues?
- Do I know how to paste the fix into Lovable?
- Is everything working correctly now?

**‚úÖ Troubleshooting Complete:** I can fix common issues

---

## Final Verification Checklist

### ‚úÖ Complete Before Moving On:

**Service Creation:**
- [ ] All required fields have validation
- [ ] Form saves to Supabase successfully
- [ ] Redirects to dashboard after creation
- [ ] Mobile keyboard works properly
- [ ] Error messages are helpful

**Service Display:**
- [ ] Table shows all operator's services
- [ ] Search filters results correctly
- [ ] Category filter works
- [ ] Mobile cards display properly
- [ ] Empty state shows for new operators

**Edit Functionality:**
- [ ] Modal opens with current data
- [ ] All fields are editable
- [ ] Validation works same as create
- [ ] Changes save successfully
- [ ] Unsaved changes warning works

**Delete Functionality:**
- [ ] Confirmation dialog appears
- [ ] Service name shown in dialog
- [ ] Delete removes from table
- [ ] Success message displays
- [ ] Cannot accidentally delete

**Professional Features:**
- [ ] Sort columns work
- [ ] Business metrics display
- [ ] Bulk operations available
- [ ] Mobile swipe actions work
- [ ] Export to CSV works

**Overall Quality:**
- [ ] Looks professional and trustworthy
- [ ] Works smoothly without bugs
- [ ] Mobile experience is excellent
- [ ] Loading states are clear
- [ ] Error handling is robust

### üìù Final Reflection:
- Does this feel like professional business software?
- Would I pay to use this service management system?
- Can operators efficiently manage their business with this?

**‚úÖ Service Management Complete:** You've built a production-ready CRUD system!

---

## What's Coming Next

### In Step 4.3 (Image Upload):
You'll add professional image capabilities so operators can showcase their services with photos. This will integrate directly with the service management you just built!

### Why Image Upload Matters:
- Services with photos get 3x more bookings
- Visual appeal builds customer trust
- Professional presentation increases prices operators can charge
- Gallery management showcases operator expertise

### The Power of Complete Operator Tools:
By the end of Step 4, operators will have:
- A professional dashboard (4.1)
- Complete service management (4.2)
- Image upload and galleries (4.3)
- Everything needed to run a successful drone business

### üìù Prepare for Next Step:
- Test creating a few different services
- Try editing and deleting to see the flow
- Think about what images would help sell services
- Keep your Lovable project open

**Next Step:** Continue to `4.3-image-upload.md` to add professional image capabilities!

---

**üéØ Pro Tips:**
- The form components you built are reusable across your entire app
- Save your project after completing service management
- Test with different service types to see how they display
- The patterns you learned here apply to any CRUD system

**üí° Remember:** You just built the same type of functionality found in Airbnb, Uber, and TaskRabbit. This is real marketplace software that could power an actual business. You're no longer just learning - you're building production-ready applications!